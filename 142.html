<html>

<head>
  <title>Document</title>
</head>
<link rel="stylesheet" href="js/style.css">
<style>
  body {
    /* background-color: hsl(200, 60%, 60%); */
    color: var(--c2);
    display: flex;
    justify-content: center;
    flex-direction: column;
    align-items: center;
    padding: 1em;
    font-size: 3em;
    font-family: 'Franklin Gothic Medium', Arial, sans-serif;
  }
  #div1{
    font-size: 0.5em;
  }
</style>

<body>
  <div id="cont1">
    
    <div id="title">東京の温湿度</div>
    <div id="div1"></div>
    <div id="div2"></div>
    <div id="div3"></div>
  </div>
</body>

<script>
  const div1 = document.getElementById("div1")
  const div2 = document.getElementById("div2")
  const div3 = document.getElementById("div3")
  const txtUrl = "https://www.jma.go.jp/bosai/amedas/data/latest_time.txt"



  function rgb2code(rgb) {
    return "#" + rgb.map((v) => {
      return ("0" + v.toString(16)).slice(-2);
    }).join("");
  }

  fetch(txtUrl)
    .then(response => response.text())
    .then(timeData => {
      let time = timeData
        .replaceAll("-", "")
        .replaceAll(":", "")
        .replaceAll("T", "")
        .replaceAll(":", "")
        .slice(0, 14)

      let url = `https://www.jma.go.jp/bosai/amedas/data/map/${time}.json`

      fetch(url)
        .then(response => response.json())
        .then(skyData => {
          div1.textContent = timeData.slice(0, 16)
            .replaceAll("T", " ")
            .replaceAll("-", "/")
          div2.textContent = skyData["44132"].temp[0].toString().slice(0, 2) + "C"
          div3.textContent = skyData["44132"].humidity[0] + "%"
          let temp = skyData["44132"].temp[0] / 30
          let humid = skyData["44132"].humidity[0] / 100

          let hsb = [180 + 30 * 1, 30, 30]

          document.body.style.backgroundColor = `hsl(${hsb[0]},${hsb[1]}%,${hsb[2]}%)`;
        })
    })
</script>

</html>