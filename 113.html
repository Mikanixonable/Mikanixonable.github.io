<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>D3.js(Force Layout)の練習</title>
  <style>

  </style>
</head>
<body>
  <script src="http://d3js.org/d3.v3.js" charset="utf-8"></script>
  <script>
    var w = 800;
    var h = 500;
    var nodes = [ {id:0, label:"A"},
                  {id:1, label:"B"},
                  {id:2, label:"C"},
                  {id:3, label:"D"}
                ];
    var links = [ {source:0, target:1},
                  {source:0, target:2},
                  {source:1, target:3},
                  {source:1, target:3}
                ];
   var force = d3.layout.force()
                 .nodes(nodes)
                 .links(links)
                 .size([w, h])
                 .linkStrength(0.1)
                 .friction(0.9)
                 .distance(200)
                 .charge(-30)
                 .gravity(0.1)
                 .theta(0.8)
                 .alpha(0.1)
                 .start(); 

    var svg = d3.select("body").append("svg").attr({width:w, height:h});
    var link = svg.selectAll("line")
                  .data(links)
                  .enter()
                  .append("line")
                  .style({"stroke": "#ccc",
                          "stroke-width": 1});
    var node = svg.selectAll("circle")
                  .data(nodes)
                  .enter()
                  .append("circle")
                  .attr({r: 20,
                         opacity: 0.5})
                  .style({"fill": "red"})
                  .call(force.drag);

    var label = svg.selectAll('text')
                    .data(nodes)
                    .enter()
                    .append('text')
                    .attr({"text-anchor":"middle",
                           "fill":"white"})
                    .style({"font-size":11})
                    .text(function(d) { return d.label; });

    force.on("tick", function() {
      link.attr({x1: function(d) { return d.source.x; },
                 y1: function(d) { return d.source.y; },
                 x2: function(d) { return d.target.x; },
                 y2: function(d) { return d.target.y; }});
      node.attr({cx: function(d) { return d.x; },
                 cy: function(d) { return d.y; }});
      label.attr({x: function(d) { return d.x; },
                  y: function(d) { return d.y; }});
    });
  </script>
</body>
</html>